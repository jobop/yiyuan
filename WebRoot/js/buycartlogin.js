jQuery(function(a){var d=0;function f(l){var k=/^[0-9]{6}$/;if(!k.exec(l)){return false}return true}function j(k){var l=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;if(l.test(k)){return true}return false}function e(l){var k=/^[^ \f\n\r\t\v]{6,16}$/;if(!k.exec(l)){return false}return true}function b(l){var k=/^1\d{10}$/;if(!k.exec(l)){return false}else{return true}}function i(k,l){document.cookie=k+"="+escape(l)+";id=1ypg;path=/;domain="+$domain}function h(l,n,k){var m=k;var o=new Date();o.setTime(o.getTime()+m*24*60*60*1000);document.cookie=l+"="+escape(n)+";id=1ypg;path=/;expires="+o.toGMTString()+";domain="+$domain}function g(l){var k=document.cookie.match(new RegExp("(^| )"+l+"=([^;]*)(;|$)"));if(k!=null){return unescape(k[2])}return null}function c(){a("#btnSubmitLogin").remove();a("#loginSubmitStatus").show()}a(function(){var k=a("#username");var s=a("#pwd");var o=a("#name_ts");var u=a("#pwd_ts");var m=null;var p=null;var t=function(w,v){a("#liError").html('<div id="div_login"><p class="ts"></p>'+w+"</div>");a(v).focus()};var n=g("loginUser");if(n!=null){k.val(n);s.focus().attr("class","text_name_focus")}else{k.focus().attr("class","text_name_focus")}k.focus(function(){a(this).attr("class","text_name_focus");if(o.attr("class")=="ts"){o.attr("class","ts").html("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7/\u90ae\u7bb1")}a(this).parent().attr("class","click")}).blur(function(){a(this).attr("class","num");a(this).parent().attr("class","");r(false,false)});s.focus(function(){a(this).attr("class","text_name_focus");if(u.attr("class")=="ts"){u.attr("class","ts").html("\u8bf7\u586b\u5199\u957f\u5ea6\u4e3a6-20\u957f\u5ea6\u7684\u5b57\u7b26\u5bc6\u7801")}a(this).parent().attr("class","click")}).blur(function(){a(this).attr("class","num");a(this).parent().attr("class","");r(false,false)});var r=function(y,v){var w=/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((\.[a-zA-Z0-9_-]{2,3}){1,2})$/;var x=/^1[3-9]\d{9}$/;m=k.val();p=s.val();o.attr("class","ts").html("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7/\u90ae\u7bb1");u.attr("class","ts").html("\u8bf7\u586b\u5199\u957f\u5ea6\u4e3a6-20\u957f\u5ea6\u7684\u5b57\u7b26\u5bc6\u7801");if(m==""){if(y){k.focus()}s.attr("class","num");if(v){o.attr("class","wrong").html("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7/\u90ae\u7bb1\uff01")}return false}else{if(!b(m)&&!j(m)){if(y){k.focus()}s.attr("class","num");o.attr("class","wrong").html("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7/\u90ae\u7bb1\uff01");return false}}if(p==""){if(y){s.focus()}k.attr("class","num");if(v){u.attr("class","wrong").html("\u8bf7\u8f93\u5165\u767b\u5f55\u5bc6\u7801\uff01")}return false}else{if(!e(p)){if(y){s.focus()}k.attr("class","num");u.attr("class","wrong").html("\u767b\u5f55\u5bc6\u7801\u4e3a6-20\u957f\u5ea6\u7684\u5b57\u7b26\uff01");return false}}return true};var q="";var l=function(w){if(!isLoaded){return}var x=false;var v=false;if(w==0){x=true;v=true}if(w==1){x=true;v=false}if(r(x,v)){if(q!=m){a.ajax({url:"/login/login.html",data:"userName="+m+"&pwd="+p,beforeSend:c,success:function(y){if(y=="userError"){k.focus();o.attr("class","wrong").html("\u767B\u5F55\u5E10\u53F7\u4E0D\u5B58\u5728\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165\uFF01");a("#loginSubmitStatus").before('<input id="btnSubmitLogin" type="button" name="login_init" value="\u767b\u5f55" class="login_init"/>');a("#loginSubmitStatus").hide();q=m}else{if(y=="pwdError"){s.focus();u.attr("class","wrong").html("\u767B\u5F55\u5BC6\u7801\u9519\u8BEF\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165\uFF01");a("#loginSubmitStatus").before('<input id="btnSubmitLogin" type="button" name="login_init" value="\u767b\u5f55" class="login_init"/>');a("#loginSubmitStatus").hide()}else{if(y.userId){i("userId",y.userId);i("face",y.faceImg)}if(y.userName){i("userName",y.userName)}else{if(y.mail){i("userName",y.mail)}else{if(y.phone){i("userName",y.phone)}}}i("loginType",0);parent.location.href=$www+"/cartPay/payment.html"}}h("loginUser",m,365)},error:function(){alert("\u8FDE\u63A5\u670D\u52A1\u5668\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5\uFF01");window.location.href=$www}})}else{o.attr("class","wrong").html("\u767B\u5F55\u5E10\u53F7\u4E0D\u5B58\u5728\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165\uFF01");k.focus()}}};a("#LoginForm").keydown(function(v){var w=(window.event)?event.keyCode:v.keyCode;if(w==32){return false}else{if(w==13){l(1)}}return true});a("#btnSubmitLogin").live("click",function(){l(0)});isLoaded=true;QC.Login({btnId:"qqLoginBtn",scope:"get_user_info,add_share",size:"B_M"},function(v,w){if(QC.Login.check()){QC.Login.getMe(function(y,x){a.ajax({url:"/register/authorizeIsExists.action",type:"POST",data:"openId="+encodeURIComponent(y.replace(/(\/)/g,"")),success:function(z){if(z=="true"){a.ajax({type:"POST",url:"/register/authorizeRegsiter.action",data:"userName="+encodeURIComponent(v.nickname.replace(/(\/)/g,""))+"&openId="+y+"&userFace="+v.figureurl_2,success:function(A){i("userId",A.userId);i("userName",A.userName);i("face",A.faceImg);i("loginType",2);parent.location.href=$www+"/cartPay/payment.html"}})}else{i("userId",z.userId);i("userName",z.userName);i("face",z.faceImg);i("loginType",2);parent.location.href=$www+"/cartPay/payment.html"}}})})}})})});
